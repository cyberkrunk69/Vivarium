<svg xmlns="http://www.w3.org/2000/svg" width="1520" height="980" viewBox="0 0 1520 980" role="img" aria-labelledby="title desc">
  <title id="title">Vivarium MVP Runtime Architecture</title>
  <desc id="desc">Static architecture diagram showing launcher scripts, runtime services, mutable state, audit trail, and mailbox/context orchestration.</desc>
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#475569"/>
    </marker>
    <style>
      .title { font: 700 30px Inter,Segoe UI,Arial,sans-serif; fill: #0f172a; }
      .subtitle { font: 500 15px Inter,Segoe UI,Arial,sans-serif; fill: #475569; }
      .group { fill: #f8fafc; stroke: #cbd5e1; stroke-width: 2; rx: 14; }
      .group-label { font: 700 18px Inter,Segoe UI,Arial,sans-serif; fill: #1e293b; }
      .proc { fill: #e0f2fe; stroke: #0284c7; stroke-width: 2; rx: 10; }
      .data { fill: #dcfce7; stroke: #16a34a; stroke-width: 2; rx: 10; }
      .note { fill: #ede9fe; stroke: #7c3aed; stroke-width: 2; rx: 10; }
      .warn { fill: #fef3c7; stroke: #d97706; stroke-width: 2; rx: 10; }
      .ntext { font: 600 13px Inter,Segoe UI,Arial,sans-serif; fill: #0f172a; }
      .small { font: 500 12px Inter,Segoe UI,Arial,sans-serif; fill: #334155; }
      .edge { stroke: #475569; stroke-width: 2; fill: none; marker-end: url(#arrow); }
      .edge-dashed { stroke: #64748b; stroke-width: 2; fill: none; stroke-dasharray: 7 6; marker-end: url(#arrow); }
      .legend { font: 600 12px Inter,Segoe UI,Arial,sans-serif; fill: #334155; }
    </style>
  </defs>

  <rect x="0" y="0" width="1520" height="980" fill="#ffffff"/>
  <text x="40" y="54" class="title">Vivarium MVP Runtime Architecture (Static SVG)</text>
  <text x="40" y="82" class="subtitle">Golden-path runtime with queue worker, cycle API, mailbox orchestration, and deterministic context compaction.</text>

  <!-- Launch and operator -->
  <rect x="40" y="110" width="340" height="300" class="group"/>
  <text x="58" y="140" class="group-label">Launch + Operator</text>

  <rect x="68" y="168" width="126" height="54" class="warn"/>
  <text x="89" y="199" class="ntext">Human</text>

  <rect x="212" y="158" width="150" height="66" class="proc"/>
  <text x="228" y="187" class="ntext">Launcher scripts</text>
  <text x="226" y="205" class="small">mac / ps1 / bat</text>

  <rect x="212" y="246" width="150" height="62" class="proc"/>
  <text x="230" y="277" class="ntext">dev_launcher.py</text>

  <rect x="212" y="330" width="150" height="58" class="data"/>
  <text x="236" y="363" class="ntext">Install cache</text>

  <path d="M194 195 L212 190" class="edge"/>
  <path d="M287 224 L287 246" class="edge"/>
  <path d="M287 308 L287 330" class="edge"/>

  <!-- Runtime -->
  <rect x="420" y="110" width="360" height="300" class="group"/>
  <text x="438" y="140" class="group-label">Runtime Processes</text>

  <rect x="448" y="168" width="148" height="62" class="proc"/>
  <text x="466" y="197" class="ntext">Control panel UI</text>
  <text x="470" y="215" class="small">control_panel_app.py</text>

  <rect x="608" y="168" width="148" height="62" class="proc"/>
  <text x="638" y="197" class="ntext">Cycle API</text>
  <text x="629" y="215" class="small">swarm_api.py</text>

  <rect x="526" y="252" width="148" height="62" class="proc"/>
  <text x="540" y="281" class="ntext">Worker runtime</text>
  <text x="530" y="299" class="small">queue executor loop</text>

  <rect x="526" y="336" width="148" height="54" class="data"/>
  <text x="560" y="368" class="ntext">queue.json</text>

  <path d="M362 278 C400 278, 410 200, 448 200" class="edge"/>
  <path d="M362 278 C405 278, 420 200, 608 200" class="edge"/>
  <path d="M194 202 C340 202, 354 200, 448 200" class="edge"/>
  <path d="M600 230 L600 252" class="edge"/>
  <path d="M600 314 L600 336" class="edge"/>
  <path d="M560 336 L560 314" class="edge-dashed"/>

  <!-- Mutable state -->
  <rect x="820" y="110" width="660" height="300" class="group"/>
  <text x="838" y="140" class="group-label">Mutable State Domain</text>

  <rect x="848" y="168" width="186" height="56" class="data"/>
  <text x="885" y="201" class="ntext">identities/*.json</text>

  <rect x="1052" y="168" width="186" height="56" class="data"/>
  <text x="1087" y="201" class="ntext">free_time_balances</text>

  <rect x="1256" y="168" width="196" height="56" class="data"/>
  <text x="1305" y="201" class="ntext">bounties.json</text>

  <rect x="848" y="244" width="186" height="56" class="data"/>
  <text x="875" y="277" class="ntext">discussions/*.jsonl</text>

  <rect x="1052" y="244" width="186" height="56" class="data"/>
  <text x="1081" y="277" class="ntext">messages_to_human</text>

  <rect x="1256" y="244" width="196" height="56" class="data"/>
  <text x="1296" y="277" class="ntext">from_human / outbox</text>

  <rect x="1052" y="320" width="186" height="56" class="data"/>
  <text x="1086" y="353" class="ntext">mailbox_quests</text>

  <path d="M674 284 C760 284, 760 196, 848 196" class="edge"/>
  <path d="M674 284 C770 284, 770 272, 848 272" class="edge"/>
  <path d="M596 200 C760 200, 760 272, 1052 272" class="edge"/>
  <path d="M596 200 C760 200, 760 348, 1052 348" class="edge"/>

  <!-- Audit -->
  <rect x="40" y="448" width="900" height="244" class="group"/>
  <text x="58" y="478" class="group-label">Audit + Review Trail</text>

  <rect x="82" y="512" width="184" height="62" class="data"/>
  <text x="109" y="541" class="ntext">execution_log.jsonl</text>

  <rect x="286" y="512" width="184" height="62" class="data"/>
  <text x="326" y="541" class="ntext">action_log.jsonl</text>

  <rect x="500" y="506" width="256" height="74" class="note"/>
  <text x="540" y="535" class="ntext">review lifecycle</text>
  <text x="526" y="553" class="small">pending_review / approved</text>
  <text x="545" y="569" class="small">requeue / failed</text>

  <path d="M526 314 C526 386, 174 386, 174 512" class="edge"/>
  <path d="M526 314 C526 402, 378 402, 378 512" class="edge"/>
  <path d="M266 542 L500 542" class="edge"/>
  <path d="M628 580 C628 640, 600 640, 600 390" class="edge"/>
  <path d="M448 200 C448 402, 378 402, 378 512" class="edge-dashed"/>
  <path d="M448 200 C448 382, 174 382, 174 512" class="edge-dashed"/>

  <!-- Mailbox / context -->
  <rect x="980" y="448" width="500" height="452" class="group"/>
  <text x="998" y="478" class="group-label">Mailbox + Context Orchestration</text>

  <rect x="1010" y="512" width="210" height="68" class="note"/>
  <text x="1034" y="542" class="ntext">Thread inbox/outbox</text>
  <text x="1036" y="560" class="small">human async channels</text>

  <rect x="1240" y="512" width="210" height="68" class="note"/>
  <text x="1283" y="542" class="ntext">Quest manager</text>
  <text x="1268" y="560" class="small">assign / status / control</text>

  <rect x="1010" y="596" width="210" height="68" class="note"/>
  <text x="1052" y="626" class="ntext">Tip/Pause/Resume</text>
  <text x="1064" y="644" class="small">operator controls</text>

  <rect x="1240" y="596" width="210" height="68" class="note"/>
  <text x="1260" y="626" class="ntext">Realtime polling UI</text>
  <text x="1268" y="644" class="small">live task visibility</text>

  <rect x="1010" y="690" width="440" height="188" class="note"/>
  <text x="1034" y="722" class="ntext">Deterministic context compaction</text>
  <text x="1036" y="748" class="small">get_discussion_context() + get_enrichment_context()</text>
  <text x="1036" y="772" class="small">checkSelf, checkMemory, checkMailbox, checkBounties,</text>
  <text x="1036" y="794" class="small">checkGuild, checkLibrary, checkIdentityTools</text>
  <text x="1036" y="826" class="small">Produces compact menu/metrics payload for /cycle</text>

  <path d="M596 200 C900 200, 900 546, 1010 546" class="edge"/>
  <path d="M596 200 C900 200, 900 546, 1240 546" class="edge"/>
  <path d="M1120 580 L1120 596" class="edge"/>
  <path d="M1346 580 L1346 596" class="edge"/>
  <path d="M1320 664 L1320 690" class="edge"/>
  <path d="M1240 546 C1160 546, 1160 348, 1238 348" class="edge"/>
  <path d="M1110 664 C1110 732, 1180 732, 1180 376" class="edge"/>
  <path d="M1320 878 C1320 930, 690 930, 690 200" class="edge-dashed"/>

  <!-- Legend -->
  <rect x="40" y="728" width="900" height="172" class="group"/>
  <text x="58" y="758" class="group-label">Legend</text>
  <rect x="86" y="784" width="160" height="44" class="proc"/>
  <text x="142" y="811" class="legend">Process</text>
  <rect x="274" y="784" width="160" height="44" class="data"/>
  <text x="342" y="811" class="legend">State file</text>
  <rect x="462" y="784" width="160" height="44" class="note"/>
  <text x="537" y="811" class="legend">Controller</text>
  <rect x="650" y="784" width="160" height="44" class="warn"/>
  <text x="712" y="811" class="legend">Actor</text>
  <line x1="86" y1="856" x2="210" y2="856" class="edge"/>
  <text x="224" y="861" class="legend">solid arrow = write/call/control flow</text>
  <line x1="522" y1="856" x2="646" y2="856" class="edge-dashed"/>
  <text x="662" y="861" class="legend">dashed arrow = read/observe feedback</text>
</svg>
