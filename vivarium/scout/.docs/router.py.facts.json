{"ast_hash": "e2caea9802dd6fa9c3d360e2a96703f76824af4082ce412788e0fd80767b9218", "control_flow": {"TriggerRouter._list_python_files": [{"blocks": [{"condition": "not base.exists()", "line": 347, "type": "if"}], "function_name": "TriggerRouter._list_python_files"}], "TriggerRouter._load_symbol_docs": [{"blocks": [{"condition": "parts", "line": 761, "type": "if"}], "function_name": "TriggerRouter._load_symbol_docs"}], "TriggerRouter._parse_nav_json": [{"blocks": [{"condition": "content.startswith('```')", "line": 365, "type": "if"}], "function_name": "TriggerRouter._parse_nav_json"}], "TriggerRouter._process_file": [{"blocks": [{"condition": "not validation.is_valid", "line": 989, "type": "if"}, {"condition": "not validation.is_valid", "line": 1016, "type": "if"}, {"condition": "enable_commit", "line": 1043, "type": "if"}, {"condition": "enable_pr", "line": 1048, "type": "if"}, {"condition": "enable_impact", "line": 1053, "type": "if"}, {"condition": "draft_coros", "line": 1059, "type": "if"}, {"condition": "self._affects_module_boundary(file, nav_result)", "line": 1070, "type": "if"}], "function_name": "TriggerRouter._process_file"}], "TriggerRouter._update_module_brief": [{"blocks": [{"condition": "not content", "line": 728, "type": "if"}], "function_name": "TriggerRouter._update_module_brief"}], "TriggerRouter.on_file_save": [{"blocks": [{"condition": "not relevant", "line": 165, "type": "if"}, {"condition": "not self.config.should_process(estimated, hourly_spend=self.audit.hourly_spend()", "line": 174, "type": "if"}], "function_name": "TriggerRouter.on_file_save"}], "TriggerRouter.on_git_commit": [{"blocks": [{"condition": "not relevant", "line": 199, "type": "if"}, {"condition": "not self.config.should_process(estimated, hourly_spend=self.audit.hourly_spend()", "line": 209, "type": "if"}, {"condition": "self.audit.hourly_spend() + estimated > hourly_budget", "line": 225, "type": "if"}], "function_name": "TriggerRouter.on_git_commit"}], "TriggerRouter.on_manual_trigger": [{"blocks": [{"condition": "not relevant", "line": 615, "type": "if"}, {"condition": "not self.config.should_process(estimated, hourly_spend=self.audit.hourly_spend()", "line": 624, "type": "if"}], "function_name": "TriggerRouter.on_manual_trigger"}], "check_budget_with_message": [{"blocks": [{"condition": "remaining < estimated_cost", "line": 61, "type": "if"}], "function_name": "check_budget_with_message"}]}, "imports": ["__future__.annotations", "asyncio", "dataclasses.dataclass", "dataclasses.field", "json", "logging", "logging", "os", "os", "os", "pathlib.Path", "sys", "time", "typing.Any", "typing.Callable", "typing.Dict", "typing.List", "typing.Optional", "uuid", "vivarium.scout.audit.AuditLog", "vivarium.scout.big_brain.call_big_brain_async", "vivarium.scout.big_brain.call_big_brain_async", "vivarium.scout.big_brain.call_big_brain_async", "vivarium.scout.cli.index.query_for_nav", "vivarium.scout.config.HARD_MAX_HOURLY_BUDGET", "vivarium.scout.config.ScoutConfig", "vivarium.scout.config.get_global_semaphore", "vivarium.scout.deps.DependencyGraph", "vivarium.scout.git_analyzer.get_changed_files", "vivarium.scout.git_analyzer.get_diff_for_file", "vivarium.scout.git_analyzer.get_diff_for_file", "vivarium.scout.git_analyzer.get_diff_for_file", "vivarium.scout.git_drafts.assemble_commit_message", "vivarium.scout.ignore.IgnorePatterns", "vivarium.scout.llm.call_groq_async", "vivarium.scout.llm.call_groq_async", "vivarium.scout.llm.call_groq_async", "vivarium.scout.llm.call_groq_async", "vivarium.scout.validator.ValidationResult", "vivarium.scout.validator.Validator", "vivarium.scout.validator.validate_location"], "path": "/Users/vivariumenv1/Vivarium/vivarium/scout/router.py", "symbols": {"BRIEF_COST_PER_FILE": {"defined_at": 30, "docstring": null, "fields": [], "methods": [], "name": "BRIEF_COST_PER_FILE", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [723], "value": "0.005"}, "BudgetExhaustedError": {"defined_at": 36, "docstring": null, "fields": [], "methods": [], "name": "BudgetExhaustedError", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "class", "type_annotation": null, "used_at": [275], "value": null}, "COST_PER_MILLION_70B": {"defined_at": 29, "docstring": null, "fields": [], "methods": [], "name": "COST_PER_MILLION_70B", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [], "value": "0.9"}, "COST_PER_MILLION_8B": {"defined_at": 28, "docstring": null, "fields": [], "methods": [], "name": "COST_PER_MILLION_8B", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [157], "value": "0.2"}, "DRAFT_COST_PER_FILE": {"defined_at": 33, "docstring": null, "fields": [], "methods": [], "name": "DRAFT_COST_PER_FILE", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [270, 281], "value": "0.0004"}, "NavResult": {"defined_at": 77, "docstring": null, "fields": [], "methods": [], "name": "NavResult", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "class", "type_annotation": null, "used_at": [656, 664, 672, 704, 734], "value": null}, "SymbolDoc": {"defined_at": 88, "docstring": null, "fields": [], "methods": [], "name": "SymbolDoc", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "class", "type_annotation": null, "used_at": [704, 707, 709], "value": null}, "TASK_NAV_ESTIMATED_COST": {"defined_at": 31, "docstring": null, "fields": [], "methods": [], "name": "TASK_NAV_ESTIMATED_COST", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [342], "value": "0.002"}, "TOKENS_PER_SMALL_FILE": {"defined_at": 27, "docstring": null, "fields": [], "methods": [], "name": "TOKENS_PER_SMALL_FILE", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [144, 149], "value": "500"}, "TriggerRouter": {"defined_at": 115, "docstring": null, "fields": [], "methods": ["__init__", "should_trigger", "_quick_token_estimate", "estimate_cascade_cost", "on_file_save", "on_git_commit", "prepare_commit_msg", "estimate_task_nav_cost", "_list_python_files", "_parse_nav_json", "on_manual_trigger", "_quick_parse", "_scout_nav", "_affects_module_boundary", "_is_public_api", "_detect_module", "_critical_path_files", "_generate_symbol_doc", "_write_draft", "_update_module_brief", "_create_human_ticket", "_create_pr_draft", "_load_symbol_docs", "_process_file"], "name": "TriggerRouter", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "class", "type_annotation": null, "used_at": [], "value": null}, "_notify_user": {"defined_at": 95, "docstring": null, "fields": [], "methods": [], "name": "_notify_user", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "function", "type_annotation": null, "used_at": [133], "value": null}, "check_budget_with_message": {"defined_at": 42, "docstring": null, "fields": [], "methods": [], "name": "check_budget_with_message", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "function", "type_annotation": null, "used_at": [272], "value": null}, "logger": {"defined_at": 24, "docstring": null, "fields": [], "methods": [], "name": "logger", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "constant", "type_annotation": null, "used_at": [322, 774, 785, 820, 846, 848], "value": "logging.getLogger(__name__)"}, "on_git_commit": {"defined_at": 103, "docstring": null, "fields": [], "methods": [], "name": "on_git_commit", "purpose_hint": null, "semantic_role": null, "signature": null, "type": "function", "type_annotation": null, "used_at": [], "value": null}}}